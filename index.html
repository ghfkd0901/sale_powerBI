<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>Power BI 판매량 분석 대시보드</title>
  <style>
    body {
      display: flex;
      margin: 0;
      font-family: 'Segoe UI', sans-serif;
    }
    .sidebar {
      width: 280px;
      background-color: #f8f9fa;
      padding: 20px;
      height: 100vh;
      box-shadow: 2px 0 5px rgba(0,0,0,0.1);
      overflow-y: auto;
    }
    .sidebar h1 {
      font-size: 18px;
      margin-bottom: 5px;
      color: #2c3e50;
    }
    .sidebar p {
      font-size: 12px;
      color: #7f8c8d;
      margin-bottom: 30px;
      line-height: 1.5;
    }
    
    .menu-category {
      margin-bottom: 15px;
    }
    
    .category-header {
      display: flex;
      align-items: center;
      padding: 12px;
      background-color: #e9ecef;
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.3s ease;
      user-select: none;
      font-weight: 600;
      color: #495057;
    }
    
    .category-header:hover {
      background-color: #dee2e6;
      transform: translateY(-1px);
    }
    
    .category-header.active {
      background-color: #007bff;
      color: white;
    }
    
    .toggle-icon {
      margin-left: auto;
      transition: transform 0.3s ease;
      font-size: 12px;
    }
    
    .toggle-icon.rotated {
      transform: rotate(180deg);
    }
    
    .sub-menu {
      max-height: 0;
      overflow: hidden;
      transition: max-height 0.3s ease;
      background-color: white;
      border-radius: 0 0 8px 8px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    
    .sub-menu.expanded {
      max-height: 500px;
      margin-top: 2px;
    }
    
    .sub-menu a {
      display: block;
      padding: 12px 20px;
      color: #495057;
      text-decoration: none;
      border-bottom: 1px solid #f1f3f4;
      transition: all 0.2s ease;
      font-size: 14px;
    }
    
    .sub-menu a:last-child {
      border-bottom: none;
    }
    
    .sub-menu a:hover {
      background-color: #f8f9fa;
      color: #007bff;
      padding-left: 25px;
    }
    
    .sub-menu a.active {
      background-color: #007bff;
      color: white;
    }
    
    .content {
      flex: 1;
    }
    
    iframe {
      border: none;
      width: 100%;
      height: 100vh;
    }
    
    .welcome-message {
      display: flex;
      align-items: center;
      justify-content: center;
      height: 100vh;
      font-size: 24px;
      color: #6c757d;
      text-align: center;
      background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
    }
  </style>
</head>
<body>

  <div class="sidebar">
    <h1>대성에너지 판매량 분석</h1>
    <p>저자: 마케팅기획팀 배경호 사원</p>

    <!-- 판매량 분석 카테고리 -->
    <div class="menu-category">
      <div class="category-header" onclick="toggleCategory('sales')">
        <span>판매량 분석</span>
        <span class="toggle-icon" id="sales-icon">▼</span>
      </div>
      <div class="sub-menu" id="sales-menu">
        <a href="#" onclick="loadReport('customer', this)">고객별 판매량 분석</a>
        <a href="#" onclick="loadReport('yoy', this)">전년동월 판매량 분석</a>
        <a href="#" onclick="loadReport('yoy_cum', this)">전년동월 누계 판매량 분석</a>
        <a href="#" onclick="loadReport('new', this)">신규 판매량</a>
        <a href="#" onclick="loadReport('closed', this)">폐전 판매량</a>
      </div>
    </div>

    <!-- 전수 분석 카테고리 -->
    <div class="menu-category">
      <div class="category-header" onclick="toggleCategory('comprehensive')">
        <span>전수 분석</span>
        <span class="toggle-icon" id="comprehensive-icon">▼</span>
      </div>
      <div class="sub-menu" id="comprehensive-menu">
        <a href="#" onclick="loadReport('comprehensive1', this)">보급률</a>
        <a href="#" onclick="loadReport('comprehensive2', this)">전수</a>
        <a href="#" onclick="loadReport('comprehensive3', this)">전월대비표</a>
      </div>
    </div>

    <!-- 타사 분석 카테고리 -->
    <div class="menu-category">
      <div class="category-header" onclick="toggleCategory('competitor')">
        <span>타사 분석</span>
        <span class="toggle-icon" id="competitor-icon">▼</span>
      </div>
      <div class="sub-menu" id="competitor-menu">
        <a href="#" onclick="loadReport('competitor1', this)">용도별 판매량</a>
        <a href="#" onclick="loadReport('competitor2', this)">상품별 판매량</a>
        <a href="#" onclick="loadReport('competitor3', this)">냉난방용 비율</a>
      </div>
    </div>

    <!-- 요금분석 카테고리 -->
    <div class="menu-category">
      <div class="category-header" onclick="loadReport('pricing', this)">
        <span>요금분석</span>
      </div>
    </div>

    <!-- 기온및공급량 카테고리 -->
    <div class="menu-category">
      <div class="category-header" onclick="loadReport('temperature_supply', this)">
        <span>기온및공급량</span>
      </div>
    </div>
  </div>

  <div class="content">
    <div class="welcome-message" id="welcomeMessage">
      분석 항목을 선택해주세요
    </div>
    <iframe id="reportFrame" style="display: none;" title="Power BI 보고서"></iframe>
  </div>

  <script>
    // Power BI 링크 매핑 (실제 링크로 교체해주세요)
    const reportLinks = {
      // 판매량 분석
      customer: "https://app.powerbi.com/view?r=eyJrIjoiYjlmMDhmOTctMzBkMC00OGQ5LWFiNWItNTI5YjU4Y2Q2OWNlIiwidCI6Ijk2NmVhMWY0LWI5MjEtNDBmMS04MzIxLWNiMWVmMmE3OTY2MCJ9&pageName=f6006888ce63629db4d6",
      yoy: "https://app.powerbi.com/view?r=eyJrIjoiYjlmMDhmOTctMzBkMC00OGQ5LWFiNWItNTI5YjU4Y2Q2OWNlIiwidCI6Ijk2NmVhMWY0LWI5MjEtNDBmMS04MzIxLWNiMWVmMmE3OTY2MCJ9&pageName=4f9527bb1221b07cb227",
      yoy_cum: "https://app.powerbi.com/view?r=eyJrIjoiYjlmMDhmOTctMzBkMC00OGQ5LWFiNWItNTI5YjU4Y2Q2OWNlIiwidCI6Ijk2NmVhMWY0LWI5MjEtNDBmMS04MzIxLWNiMWVmMmE3OTY2MCJ9&pageName=26fce2d5582173677a79",
      new: "https://app.powerbi.com/view?r=eyJrIjoiYjlmMDhmOTctMzBkMC00OGQ5LWFiNWItNTI5YjU4Y2Q2OWNlIiwidCI6Ijk2NmVhMWY0LWI5MjEtNDBmMS04MzIxLWNiMWVmMmE3OTY2MCJ9&pageName=cb782fe0ca7585c905ae",
      closed: "https://app.powerbi.com/view?r=eyJrIjoiYjlmMDhmOTctMzBkMC00OGQ5LWFiNWItNTI5YjU4Y2Q2OWNlIiwidCI6Ijk2NmVhMWY0LWI5MjEtNDBmMS04MzIxLWNiMWVmMmE3OTY2MCJ9&pageName=62e6b17c1a0b9a5b7ba0",
      
      // 전수 분석
      comprehensive1: "https://app.powerbi.com/view?r=eyJrIjoiN2YxNzAxNGUtM2UyOC00NTU1LWFiZTQtODVkMDI4ZTU0YWE1IiwidCI6Ijk2NmVhMWY0LWI5MjEtNDBmMS04MzIxLWNiMWVmMmE3OTY2MCJ9&pageName=671016c5209034d03e33",
      comprehensive2: "https://app.powerbi.com/view?r=eyJrIjoiN2YxNzAxNGUtM2UyOC00NTU1LWFiZTQtODVkMDI4ZTU0YWE1IiwidCI6Ijk2NmVhMWY0LWI5MjEtNDBmMS04MzIxLWNiMWVmMmE3OTY2MCJ9&pageName=56f356b070e835a29d10",
      comprehensive3: "https://app.powerbi.com/view?r=eyJrIjoiN2YxNzAxNGUtM2UyOC00NTU1LWFiZTQtODVkMDI4ZTU0YWE1IiwidCI6Ijk2NmVhMWY0LWI5MjEtNDBmMS04MzIxLWNiMWVmMmE3OTY2MCJ9&pageName=8e534cd8a8576eaccc79",

      // 타사 분석
      competitor1: "https://app.powerbi.com/view?r=eyJrIjoiMjg1NTU1NTItNTEzMS00OGM5LTgzYTQtOTNlOTcxMDU2ZDMyIiwidCI6Ijk2NmVhMWY0LWI5MjEtNDBmMS04MzIxLWNiMWVmMmE3OTY2MCJ9&pageName=a033294de2a4d81f344f",
      competitor2: "https://app.powerbi.com/view?r=eyJrIjoiMjg1NTU1NTItNTEzMS00OGM5LTgzYTQtOTNlOTcxMDU2ZDMyIiwidCI6Ijk2NmVhMWY0LWI5MjEtNDBmMS04MzIxLWNiMWVmMmE3OTY2MCJ9&pageName=49eb8a32581c90568a34",
      competitor3: "https://app.powerbi.com/view?r=eyJrIjoiMjg1NTU1NTItNTEzMS00OGM5LTgzYTQtOTNlOTcxMDU2ZDMyIiwidCI6Ijk2NmVhMWY0LWI5MjEtNDBmMS04MzIxLWNiMWVmMmE3OTY2MCJ9&pageName=9e34e3765cf8251f50de",

      // 요금분석
      pricing: "https://app.powerbi.com/view?r=eyJrIjoiNjUyMDY1NGYtMGRhMi00YWU1LTg1MTgtNDNhOTljNmVjMjc2IiwidCI6Ijk2NmVhMWY0LWI5MjEtNDBmMS04MzIxLWNiMWVmMmE3OTY2MCJ9&pageName=ee8c9d2acde67ec7fd30", // 실제 Power BI 링크로 교체

      // 기온및공급량
      temperature_supply: "https://app.powerbi.com/view?r=eyJrIjoiNTRlYjc3N2QtZWY4Mi00NDcxLTgxODgtOTQ1NzA1NjkxNjgxIiwidCI6Ijk2NmVhMWY0LWI5MjEtNDBmMS04MzIxLWNiMWVmMmE3OTY2MCJ9&pageName=9d3765cde3e49b4e2770" // 실제 Power BI 링크로 교체
    };

    function toggleCategory(category) {
      const menu = document.getElementById(category + '-menu');
      const icon = document.getElementById(category + '-icon');
      const header = icon.parentElement;
      
      if (menu.classList.contains('expanded')) {
        menu.classList.remove('expanded');
        icon.classList.remove('rotated');
        header.classList.remove('active');
      } else {
        // 다른 모든 메뉴 닫기
        const allMenus = document.querySelectorAll('.sub-menu');
        const allIcons = document.querySelectorAll('.toggle-icon');
        const allHeaders = document.querySelectorAll('.category-header');
        
        allMenus.forEach(m => m.classList.remove('expanded'));
        allIcons.forEach(i => i.classList.remove('rotated'));
        allHeaders.forEach(h => h.classList.remove('active'));
        
        // 선택된 메뉴 열기
        menu.classList.add('expanded');
        icon.classList.add('rotated');
        header.classList.add('active');
      }
    }

    function loadReport(key, element) {
      const iframe = document.getElementById("reportFrame");
      const welcomeMessage = document.getElementById("welcomeMessage");
      
      // 모든 active 클래스 제거
      document.querySelectorAll('.sub-menu a').forEach(a => a.classList.remove('active'));
      document.querySelectorAll('.category-header').forEach(h => h.classList.remove('active'));
      
      // 현재 선택된 항목에 active 클래스 추가
      element.classList.add('active');
      
      if (reportLinks[key] && reportLinks[key] !== "#") {
        iframe.src = reportLinks[key];
        iframe.style.display = 'block';
        welcomeMessage.style.display = 'none';
      } else {
        alert('해당 보고서의 링크가 아직 설정되지 않았습니다.');
      }
    }

    // 페이지 로드시 첫 번째 카테고리 열기
    document.addEventListener('DOMContentLoaded', function() {
      toggleCategory('sales');
    });
  </script>

</body>
</html>